<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="templates/uiBackend.xhtml"> 


    <!--<f:metadata>
        <f:event type="preRenderView" listener="#{newProductBean.fillFormData}" /> 
    </f:metadata> -->
    <ui:define name="head">
        <style type="text/css">
            .ui-confirm-dialog-severity {
                margin: 0 7px 7px 0;
            }
        </style>
        <script  type="text/javascript">
            function reloadGalleria(){
                alert('GO!!!!!!1');            
                PrimeFaces.cw('Galleria','widget_galis',{id:'galiss',autoPlay:false,showCaption:true,panelWidth:500,panelHeight:313,custom:false},'galleria');        
            } 
        
        </script>
    </ui:define>

    <ui:define name="content" >
        <p:messages id="opsnMsg" redisplay="false" autoUpdate="true"   />
        <p:growl autoUpdate="true"/> 

        <h:form id="createProductForm"> 
            <table style="width: 100%">
                <tr>
                    <td style="vertical-align: top;">
                        <p:panel id="basicData" header="#{bundle.basicProductData}"  style="padding:0px ! important; margin: 0.1%; " > 
                            <table cellspacing="3">
                                <tr>
                                    <td style="vertical-align: top;float: right"><p:outputLabel value="#{bundle.name}* : " style="font-weight: bold"/></td>
                                    <td style="vertical-align: top;"><p:inputText required="true" size="30" requiredMessage="#{bundle.productName}: #{bundle.mandatoryField}"  value="#{newProductBean.newProduct.name}" 
                                                                                  id="productName" /><p:message for="productName" display="icon"/>
                                    </td>
                                    <!--<td style="vertical-align: top;float: right"><p:outputLabel value="#{bundle.category} :"  style="font-weight: bold"/></td>
                                    <td style="vertical-align: top;" >

                                        <p:selectOneMenu id="productCategory" value="#{newProductBean.newProduct.productcategory}" converter="ProductcategoryConverter" required="true" requiredMessage="#{bundle.productCategory}: #{bundle.mandatoryField}" >
                                            <f:selectItem itemValue="" itemLabel="" />
                                            <f:selectItems value="#{applicationBean.productcategories}" var="pc" itemLabel="#{pc.name}" itemValue="#{pc}"   /> 
                                        </p:selectOneMenu> <br/>                                                                                

                                    </td> -->


                                    <td style="vertical-align: top; float: right"> <p:outputLabel value="#{bundle.company}* :"  style="font-weight: bold"/> </td>
                                    <td style="vertical-align: top">


                                        <p:selectOneMenu id="selectCompany" value="#{newProductBean.selectedCompany}" converter="CompanyConverter" required="true" disabled="#{sessionBean.users.role.roleid!=1}" requiredMessage="#{bundle.company}: #{bundle.mandatoryField}" >                                            
                                            <f:selectItems value="#{applicationBean.companies}" var="comp" itemLabel="#{comp.name}" itemValue="#{comp}"   /> 
                                            <p:ajax  listener="#{furnitureAction.handleCompanySelect}"  update="categoryTree"   /> 
                                        </p:selectOneMenu>
                                        <p:message for="selectCompany" display="icon"/>

                                <!--<p:selectManyMenu  disabled="{sessionBean.users.role.roleid!=1}"  required="true" value="{newProductBean.selectedCompanies}" requiredMessage="#{bundle.company}: #{bundle.mandatoryField}"
                                                   converter="CompanyConverter"  id="selectCompany" style="width:150px;height:130px" var="comp" showCheckbox="true"> 						                                                                                                                                                                              
                                    <f:selectItems value="{applicationBean.companies}" var="company" itemLabel="{company.name}" itemValue="{company}"   />						                                      
                                    <p:column>{comp.name}</p:column>                                
                                    <p:ajax  listener="{furnitureAction.handleCompanySelect}"  update="selectProductLine"   /> 
                                </p:selectManyMenu>                                    
                                <p:message for="selectCompany" display="icon"/>
                                <p:inputText readonly="true" value="{newProductBean.selectedCompanies[0].name}" rendered="#{sessionBean.users.role.roleid!=1}"  />-->
                                    </td>     

                                    <td style="vertical-align: top;float: right"><h:outputLabel value="#{bundle.insertDate}: " style="font-weight: bold" /></td>
                                    <td> 
                                        <p:calendar locale="el" size="12"  readonlyInput="true"  required="false" navigator="true" showOn="button" 
                                                    pattern="dd/MM/yyyy" value="#{newProductBean.newProduct.createddate}" id="createdate"/> 
                                    </td>                                                                                            
                                </tr>                                




                                <tr>
                                    <td style="vertical-align: top;float: right"><p:outputLabel value="#{bundle.description} :"  style="font-weight: bold"/></td>
                                    <td style="vertical-align: top;"><p:inputTextarea required="true" requiredMessage="#{bundle.productDescription}: #{bundle.mandatoryField}"  value="#{newProductBean.newProduct.description}" id="productDescription" rows="5" cols="30" />
                                        <p:message for="productDescription" display="icon"/>
                                    </td>

                                    <td style="vertical-align: top;float: right"> <p:outputLabel value="#{bundle.category}* :"  style="font-weight: bold"/> </td>
                                    <td style="vertical-align: top;" colspan="3">                                       
                                        <p:tree id="categoryTree" value="#{newProductBean.root}" var="node" selectionMode="single" selection="#{newProductBean.selectedNode}">  
                                            <p:treeNode>  
                                                <h:outputText value="#{node.name}" />  
                                            </p:treeNode>  
                                        </p:tree>                                                                                
                                    </td>
                                </tr>





                               <!-- <tr>
                                    <td><p:outputLabel value="#{bundle.subProduct} :"  style="font-weight: bold"/></td>
                                    <td>
                                        <p:selectOneRadio id="subproduct" value="{newProductBean.newProduct.subproduct}">  
                                            <f:selectItem itemLabel="#{bundle.yes}" itemValue="1" />
                                            <f:selectItem itemLabel="#{bundle.no}" itemValue="0" />
                                            <p:ajax  listener="{furnitureAction.handleSubproductSelect}"  update="selectParentProduct tesss"   /> 
                                        </p:selectOneRadio> 

                                        <p:panel id="tesss" style="border-style: none">
                                            <p:selectOneMenu value="{newProductBean.newProduct.product}" id="selectParentProduct" converter="ProductConverter" 
                                                             required="true" requiredMessage="#{bundle.subProduct}: #{bundle.mandatpryField}"  rendered="{newProductBean.newProduct.subproduct eq 1}"  >                                                                                      
                                                <f:selectItems value="{newProductBean.parentProductList}" var="prod" itemLabel="#{prod.name}" itemValue="#{prod}"   /> 
                                            </p:selectOneMenu>
                                        </p:panel>    
                                    </td>
                                </tr> -->
                            </table>

                        </p:panel>   
                    </td>

                </tr>
                <tr>
                    <td style="vertical-align: top; " >

                        <table>
                            <tr>
                                <td style="vertical-align: top">
                                    <p:panel id="imageDataAdmin" header="#{bundle.multimediaMgt}"  style="padding:0px ! important; margin-left:  10px; "  >
                                        <p:outputLabel style="font-weight: bold;color: black" value="#{bundle.images}  " /> <p:outputLabel style="font-weight: bold;" value="(#{newProductBean.images.size()}) :" /> 
                                        <p:spacer height="0" width="20" /> 
                                        <p:commandButton immediate="true"  icon="ui-icon-plusthick" action="#{furnitureAction.openSelectImageDlg}" update=""  /> 
                                        <p:commandButton icon="ui-icon-search" immediate="true"  disabled="#{newProductBean.images.size()==0}" alt="#{bundle.preview}"  oncomplete="dialogGaleria.show()" update=":galeriaForm"  /> 
                                        <p:commandButton icon="ui-icon-pencil" immediate="true"  disabled="#{newProductBean.images.size()==0}" alt="#{bundle.update}"   update="" /> 

                                        <p:separator />                                  
                                        <p:outputLabel style="font-weight: bold;color: black" value="Videos    " /> <p:outputLabel style="font-weight: bold;" value="(#{newProductBean.videos.size()}) :" /> 
                                        <p:spacer height="0" width="20" /> 
                                        <p:commandButton immediate="true"  icon="ui-icon-plusthick" action="#{furnitureAction.openSelectVideoDlg}" update=""  /> 
                                        <p:commandButton icon="ui-icon-search" immediate="true"  disabled="#{newProductBean.videos.size()==0}" alt="#{bundle.preview}"  oncomplete="dialogGaleriaVideo.show()" update=":galeriaVideoForm" /> 
                                        <p:commandButton icon="ui-icon-pencil" immediate="true"  disabled="#{newProductBean.videos.size()==0}" alt="#{bundle.update}"   update="" /> 
                                    </p:panel>
                                </td>



                                <td style="vertical-align: top">
                                    <p:tabView id="tabView">    
                                        <p:tab id="imagechar" title="#{bundle.productCharacteristics}"  style="padding:0px ! important; margin-left: 0px;  "  >
                                            <!--<p:outputLabel style="font-weight: bold;color: black" value="#{bundle.selectSpecCategory}:" /><br/>
                                            <p:spacer width="0" height="40" />-->
                                            <p:panel id="specsPanel" widgetVar="specsPanelWidget">
                                                <table>
                                                    <tr>
                                                        <td style="vertical-align: top"><p:outputLabel style="font-weight: bold;color: black" value="#{bundle.selectProductTemplate}:  " /></td>
                                                        <td><p:selectOneMenu value="#{newProductBean.newProduct.item}" converter="ItemConverter" >						 
                                                                <f:selectItem itemLabel="" itemValue=""  />
                                                                <f:selectItems value="#{applicationBean.items}" var="itm" itemLabel="#{itm.name}" itemValue="#{itm}"   />
                                                                <p:ajax  update="showSpecsButton dimensionForm:bt12"   /> 
                                                            </p:selectOneMenu> </td>
                                                        <td rowspan="2" style="vertical-align: top">
                                                            <p:commandButton  id="showSpecsButton"  disabled="#{newProductBean.selectedSpecificationCat.size()==0 and newProductBean.newProduct.item==null}"   immediate="true" 
                                                                              value="#{bundle.selectSpec}" process="@this" action="#{furnitureAction.showSpecifications()}" update=":selectSpecForm"  />    
                                                        </td>
                                                    </tr>

                                                    <td style="vertical-align: top"><p:outputLabel style="font-weight: bold;color: black" value="#{bundle.selectSpecCat}:  " /> </td>
                                                    <td><p:selectCheckboxMenu value="#{newProductBean.selectedSpecificationCat}" label="#{bundle.categories}" filter="true" 
                                                                              filterMatchMode="startsWith"   converter="SpecificationcategoryConverter"
                                                                              style="">  
                                                            <f:selectItems value="#{applicationBean.specificationCategories}" var="category" itemLabel="#{category.name}" itemValue="#{category}" />
                                                            <p:ajax    update="showSpecsButton"   /> 
                                                        </p:selectCheckboxMenu> </td>
                                                </table>



                                                <p:separator  /> 


                                                <p:commandButton id="charBtn" immediate="true"  disabled="#{newProductBean.productSpecifications.size()==0}"   oncomplete="" update="" value="#{bundle.view}" />

                                                <p:overlayPanel id="charPanel" for="charBtn" hideEffect="fade" >  
                                                    <p:dataTable id="charTable" var="char" value="#{newProductBean.productSpecifications}" rows="10" paginator="false">  
                                                        <p:column headerText="#{bundle.name}" width="20%">  
                                                            <h:outputText value="#{char.specification.name}" />                                        
                                                        </p:column>  
                                                        <p:column headerText="#{bundle.values}" width="70%">                                         
                                                            <ui:repeat var="pr" value="#{char.productvalues}" >
                                                                <h:outputText value="#{pr.svalue.name} " rendered="#{pr.svalue!=null}" /> 
                                                                <h:outputText value="#{pr.value} " rendered="#{pr.svalue==null}" /> 
                                                            </ui:repeat>                                         
                                                        </p:column>  

                                                        <p:column headerText="#{bundle.actions}" width="10%">  
                                                            <p:commandLink value="#{bundle.delete}" process="@this"  style="color:blue;text-decoration: underline;font-weight:bold;"  action="#{furnitureAction.deleteProductSpecification}" 
                                                                           update="@widgetVar(specsPanelWidget)"   >
                                                                <f:setPropertyActionListener value="#{char}" target="#{newProductBean.productSpecification}" />    
                                                            </p:commandLink> 
                                                        </p:column> 

                                                    </p:dataTable>  
                                                </p:overlayPanel>  

                                                <p:spacer width="30" height="0" />
                                                <p:outputLabel style="font-weight: bold;color: black" value="#{bundle.charecteristics}  " /> <p:outputLabel  style="font-weight: bold;" value="(#{newProductBean.productSpecifications.size()})" />  


                                            </p:panel>
                                        </p:tab>



                                        <p:tab id="dimensionTab" title="#{bundle.dimensions}"  style="padding:0px ! important; margin-left: 0px;  "  >
                                            <h:form id="dimensionForm">  
                                                <p:dataTable id="dimensionDatatable" widgetVar="dimensionDatatableWidget" value="#{newProductBean.dimesionProductSpecifications}" var="dimesionProductSpecification" rows="10" paginator="false" emptyMessage="#{bundle.noPriceInserted}"> 
                                                    <p:column headerText="#{bundle.dimensionType}"> 
                                                        <p:outputLabel value="#{dimesionProductSpecification.specification.name}" />                                                                    
                                                    </p:column>

                                                    <p:column headerText="#{bundle.value}">
                                                        <ui:repeat var="prr" value="#{dimesionProductSpecification.productvalues}" >                                                        
                                                            <h:outputText value="#{prr.value}"  /> <h:outputText value="#{prr.measurment.name}"  /> 
                                                        </ui:repeat>                                                        
                                                    </p:column>

                                                    <p:column headerText="#{bundle.actions}" width="10%">  
                                                        <p:commandLink value="#{bundle.delete}" immediate="true"  style="color:blue;text-decoration: underline;font-weight:bold;"  action="#{furnitureAction.deleteProductDimensionSpecification}" 
                                                                       update="dimensionDatatable"   >
                                                            <f:setPropertyActionListener value="#{dimesionProductSpecification}" target="#{newProductBean.productSpecification}" />    
                                                        </p:commandLink> 
                                                    </p:column>                                                   
                                                </p:dataTable> 
                                                <p:separator />

                                                <p:commandButton value="#{bundle.newDimension}" disabled="#{newProductBean.newProduct.item == null}"   id="bt12" immediate="true" process="@this"
                                                                 action="#{furnitureAction.showDimensionSpecifications()}"  onclick="selectDimensionValueDialog.show();" update=":selectDimensionValueForm:selectDimensionValuePanel" />
                                            </h:form>  
                                        </p:tab>






                                        <p:tab id="priceTab" title="#{bundle.price}"  style="padding:0px ! important; margin-left: 0px;"  >
                                            <p:panel id="pricePanel" widgetVar="pricePanelWidget">
                                                <h:form id="priceForm">
                                                    <p:messages autoUpdate="true"   />
                                                    <table> 
                                                        <tr>
                                                            <td><h:outputLabel value="#{bundle.initialPrice}:*" style="font-weight: bold"/></td>
                                                            <td>
                                                                <h:inputText id="inAmount" value="#{newProductBean.initialAmount}" size="9"  converter="DoubleConverter" required="true" requiredMessage="#{bundle.initialPrice}: #{bundle.mandatoryField}" >
                                                                    <p:ajax event="blur" listener="#{furnitureAction.updateFinalPriceCreateProduct}" update="finalPrice"  />
                                                                    <f:validateDoubleRange minimum="0.00" maximum="1000000.00" />
                                                                </h:inputText> 
                                                                <p:message for="inAmount" display="icon"/>
                                                            </td>
                                                            <td><h:outputLabel value="#{bundle.discount}:*" style="font-weight: bold"/></td>
                                                            <td>
                                                                <h:inputText id="disc" value="#{newProductBean.discount}" size="6"  converter="DoubleConverter" required="true" requiredMessage="#{bundle.discount}: #{bundle.mandatoryField}" >
                                                                    <p:ajax event="blur" listener="#{furnitureAction.updateFinalPriceCreateProduct}" update="finalPrice"  />
                                                                    <f:validateDoubleRange minimum="0.00" maximum="100.00" />
                                                                </h:inputText> 
                                                                <p:message for="disc" display="icon"/>
                                                            </td>
                                                            <td >
                                                                <h:outputLabel value="#{bundle.date}:" style="font-weight: bold"/>
                                                            </td>
                                                            <td>
                                                                <p:calendar locale="el" size="12"  readonlyInput="true"   navigator="true" showOn="button" required="true"
                                                                            requiredMessage="#{bundle.date}:#{bundle.mandatoryField}" pattern="dd/MM/yyyy" value="#{newProductBean.priceDate}" id="pricedate"/> 
                                                                <p:message for="pricedate" display="icon"/>
                                                            </td>

                                                        </tr>
                                                        <tr>
                                                            <td><h:outputLabel value="#{bundle.finalPrice}:*" style="font-weight: bold"/></td>
                                                            <td>
                                                                <h:inputText id="finalPrice" readonly="true"  value="#{newProductBean.amount}" size="9"  converter="DoubleConverter" required="true" requiredMessage="#{bundle.finalPrice}: #{bundle.mandatoryField}" />
                                                                <p:message for="finalPrice" display="icon"/>
                                                            </td>
                                                            <td><h:outputLabel value="#{bundle.currency}:*"  style="font-weight: bold"/></td>   			 		 
                                                            <td colspan="1"> 
                                                                <p:selectOneMenu value="#{newProductBean.currency}" converter="CurrencyConverter"  id="selectCurrency">						 
                                                                    <f:selectItems value="#{applicationBean.currencies}" var="currency" itemLabel="#{currency.name}" itemValue="#{currency}"   />						     
                                                                </p:selectOneMenu>
                                                                <p:message for="selectCurrency" display="icon"/>
                                                            </td>

                                                        </tr>                                             
                                                    </table>
                                                    <br/>
                                                    <p:commandButton value="#{bundle.insertPrice}" style="font-weight: bold" update="@widgetVar(pricePanelWidget)" process="priceForm"  action="#{furnitureAction.insertPriceCreateProduct}" />                                        
                                                    <p:commandButton value="#{bundle.reset}" style="font-weight: bold" update="@widgetVar(pricePanelWidget)" process="priceForm" action="#{furnitureAction.resetPriceCreateProduct}"/>

                                                    <p:separator />                                            
                                                    <p:outputLabel rendered="#{newProductBean.prices.size()>0}" style="font-weight: bold;color: black;font-size: 150%" value="#{bundle.productPrice}:" /> 
                                                    <p:spacer width="10" height="0" />
                                                    <p:outputLabel rendered="#{newProductBean.prices.size()>0}" style="font-weight: bold;font-size: 150%; color: red" value="#{newProductBean.prices.get(0).amount} #{newProductBean.prices.get(0).currency.name}" />  
                                                    <p:spacer width="30" height="0" />
                                                    <p:commandButton rendered="#{newProductBean.prices.size()>0}" value="#{bundle.resetPrice}" style="font-weight: bold" update="@widgetVar(pricePanelWidget)" process="@this" action="#{furnitureAction.resetPriceValue}"/>

                                                </h:form>
                                            </p:panel>
                                        </p:tab> 


                                        
                                        
                                        <p:tab id="connectedTab" title="#{bundle.connectedProducts}"  style="padding:0px ! important; margin-left: 0px;"  >
                                            <p:panel widgetVar="connectedPanelWidget" id="connectedPanel"    >
                                                <h:form id="connectedForm">
                                                    <p:commandButton value="#{bundle.addProduct}" onclick="selectPProductIDDialog.show()" process="@this" immediate="true" update="@widgetVar(selectPProductPanelWidget)" />                                               
                                                    <br/>
                                                    <p:dataList value="#{newProductBean.products.target}" var="parent" id="parentid" emptyMessage="#{bundle.noProducts}" 
                                                            paginator="false" rows="5" paginatorTemplate="{PreviousPageLink} {CurrentPageReport} {NextPageLink} {RowsPerPageDropdown}"  
                                                            rowsPerPageTemplate="5,10,15" type="none">  
                                                                <f:facet name="header">  
                                                                    #{bundle.parentProducts}  
                                                                </f:facet>  
                                                                <h:outputText value="#{parent.name}" style="margin-left:10px" />  
                                                                <br />  
                                                     </p:dataList> 
                                                    
                                                    <p:separator />
                                                    <p:commandButton value="#{bundle.addProduct}" onclick="selectSProductIDDialog.show()" process="@this" immediate="true" update="@widgetVar(selectSProductPanelWidget)" />     
                                                    <br/>
                                                    <p:dataList value="#{newProductBean.subProducts.target}" var="sub" id="subid"  emptyMessage="#{bundle.noProducts}" 
                                                            paginator="false" rows="5" paginatorTemplate="{PreviousPageLink} {CurrentPageReport} {NextPageLink} {RowsPerPageDropdown}"  
                                                            rowsPerPageTemplate="5,10,15" type="none">  
                                                                <f:facet name="header">  
                                                                    #{bundle.subproducts}  
                                                                </f:facet>  
                                                                <h:outputText value="#{sub.name}" style="margin-left:10px" />  
                                                                <br />  
                                                     </p:dataList>  
                                                </h:form>                                                
                                            </p:panel>
                                        </p:tab>  

                                        
                                        
                                    </p:tabView>                                          
                                </td>                                                                
                            </tr>
                            <tr>
                                <td colspan="2">
                                    <p:commandButton   value="#{bundle.insertProduct}" action="#{furnitureAction.insertProduct}" style="font-weight:bold ; margin: 10px;  "  />
                                    <p:commandButton process="@this"  value="#{bundle.resetFrom}" action="#{furnitureAction.createProduct()}" style="font-weight:bold ; margin: 10px;  "  />
                                </td>
                            </tr>
                        </table>
                    </td> 

                </tr>
            </table>
        </h:form>


        
        
        <h:form id="selectPProductForm"> 
            <p:dialog header="#{bundle.selectParentProduct}" id="selectPProductID" position="center" widgetVar="selectPProductIDDialog" modal="true" minWidth="200" minHeight="500" resizable="false">
                <p:panel id="selectPProductPanel" widgetVar="selectPProductPanelWidget">
                    <p:pickList id="ppList" value="#{newProductBean.products}" var="pp" itemValue="#{pp}" itemLabel="#{pp.name}" converter="ProductConverter"  
                                showSourceControls="false" showTargetControls="false" showCheckbox="false" showSourceFilter="true" showTargetFilter="true" filterMatchMode="contains" >  
                        <f:facet name="sourceCaption">#{bundle.available}</f:facet>  
                        <f:facet name="targetCaption">#{bundle.selected}</f:facet>  
                        <p:ajax event="transfer" listener="#{furnitureAction.selectPProduct}" />  
                        <p:column>  
                            #{pp.name}  
                        </p:column>  
                    </p:pickList>                     
                    <p:commandButton value="#{bundle.close}" onclick="selectPProductIDDialog.hide()" process="@this" immediate="true" update="@widgetVar(connectedPanelWidget)" />
                </p:panel>
            </p:dialog>
        </h:form>
        
        <h:form id="selectSProductForm"> 
            <p:dialog header="#{bundle.selectSubproduct}" id="selectSProductID" position="center" widgetVar="selectSProductIDDialog" modal="true" minWidth="200" minHeight="500" resizable="false">
                <p:panel id="selectSProductPanel" widgetVar="selectSProductPanelWidget">
                    <p:pickList id="spList" value="#{newProductBean.subProducts}" var="sp"  itemValue="#{sp}" itemLabel="#{sp.name}" converter="ProductConverter"  
                                showSourceControls="true" showTargetControls="true" showCheckbox="true" showSourceFilter="true" showTargetFilter="true" filterMatchMode="contains" >  
                        <f:facet name="sourceCaption">#{bundle.available}</f:facet>  
                        <f:facet name="targetCaption">#{bundle.selected}</f:facet>  
                        <p:ajax event="transfer" listener="#{furnitureAction.selectPProduct}" />  
                        <p:column>  
                            #{sp.name}  
                        </p:column>  
                    </p:pickList>                     
                    <p:commandButton value="#{bundle.close}" onclick="selectSProductIDDialog.hide()" process="@this" immediate="true" update="@widgetVar(connectedPanelWidget)" />
                </p:panel>
            </p:dialog>
        </h:form>
        
        
        
        

        <h:form id="selectSpecForm"> 
            <p:dialog header="#{bundle.selectSpecification}" id="selectSpecID" position="center" widgetVar="selectSpecDialog" modal="true" minWidth="200" minHeight="500" resizable="false">
                <p:dataTable id="specsTable" var="spec" value="#{newProductBean.specifications}" selection="#{newProductBean.specification}" widgetVar="specsTableWIdget"
                             emptyMessage="#{bundle.noRecordsFound}" rowIndexVar="tt"  rowKey="#{spec}" paginator="true" rows="15" >
                    <p:column headerText="#{bundle.name}" style="width:24%">  
                        <h:outputText value="#{spec.name}" />  
                    </p:column>  
                    <p:column style="width:4%">  
                        <p:commandButton id="selectButton" icon="ui-icon-search" action="#{furnitureAction.selectSpecification()}" update=":selectValueForm"  >
                            <f:setPropertyActionListener value="#{spec}" target="#{newProductBean.specification}" />
                        </p:commandButton>
                    </p:column>  
                </p:dataTable>  
            </p:dialog>
        </h:form>




        <h:form id="selectValueForm">
            <p:dialog header="#{bundle.selectSpecificationValue}" id="selectValueID" position="center" widgetVar="selectValueDialog" modal="true" resizable="false" >
                <p:messages autoUpdate="true" severity="error"/>
                <p:outputLabel style="font-weight: bold" value="#{bundle.valuesFor} #{newProductBean.specification.name} " rendered="#{newProductBean.specification.freetext==0}" />  
                <p:outputLabel style="font-weight: bold;font-style: italic" value=" (#{bundle.multipleSelection})" rendered="#{newProductBean.specification.freetext==0 and newProductBean.specification.multiplevalues==1}"/> 


                <p:selectManyCheckbox id="grid1" value="#{newProductBean.selectedSvalues}" converter="SpecificationvalueConverter"  layout="grid" columns="3" rendered="#{newProductBean.specification.freetext==0 and newProductBean.specification.multiplevalues==1}">  
                    <f:selectItems value="#{newProductBean.svalues}"  var="svalue" itemLabel="#{svalue.svalue.name}"  itemValue="#{svalue}"  /> 
                    <p:ajax update="bt1" />
                </p:selectManyCheckbox>


                <p:selectOneRadio id="grid2" value="#{newProductBean.selectedSvalue}"  converter="omnifaces.SelectItemsConverter" layout="grid" columns="3" rendered="#{newProductBean.specification.freetext==0 and newProductBean.specification.multiplevalues==0}">  
                    <f:selectItems value="#{newProductBean.svalues}" var="sval" itemLabel="#{sval.svalue.name}"  itemValue="#{sval}"/>  
                    <p:ajax update="bt2" /> 
                </p:selectOneRadio>


                <p:outputLabel style="font-weight: bold; vertical-align: top" value="#{bundle.valuesFor} :* " rendered="#{newProductBean.specification.freetext==1}"  />  
                <p:inputTextarea rows="5" cols="40" value="#{newProductBean.svalue}" rendered="#{newProductBean.specification.freetext==1}" required="true" requiredMessage="#{bundle.value}: #{bundle.mandatoryField}"/>

                <p:separator />

                <p:commandButton id="bt1" update="@widgetVar(specsPanelWidget)" action="#{furnitureAction.selectSValues}"  value="#{bundle.insert}" disabled="#{newProductBean.selectedSvalues.size()==0}" rendered="#{newProductBean.specification.freetext==0 and newProductBean.specification.multiplevalues==1}"/>
                <p:commandButton id="bt2" update="@widgetVar(specsPanelWidget)" action="#{furnitureAction.selectSValues}"  value="#{bundle.insert}" disabled="#{newProductBean.selectedSvalue==null}" rendered="#{newProductBean.specification.freetext==0 and newProductBean.specification.multiplevalues==0}"/>
                <p:commandButton id="bt3" update="@widgetVar(specsPanelWidget)" action="#{furnitureAction.selectSValues}"  value="#{bundle.insert}"  rendered="#{newProductBean.specification.freetext==1}"/>                                                                      

            </p:dialog>
        </h:form>




        <h:form id="selectDimensionValueForm">
            <p:dialog header="#{bundle.selectDimensionValue}" id="selectDimensionValueID" position="center" widgetVar="selectDimensionValueDialog" modal="false" resizable="false" >
                <p:messages autoUpdate="true" />

                <p:panel id="selectDimensionValuePanel">
                    <table>
                        <tr>
                            <td><p:outputLabel style="font-weight: bold; vertical-align: top" value="#{bundle.dimensionType} :*"   /> </td>
                            <td><p:selectOneMenu id="dimensioTypeField" value="#{newProductBean.specification}" converter="SpecificationConverter" required="true" requiredMessage="#{bundle.specification}: #{bundle.mandatoryField}">						                    
                                    <f:selectItems value="#{newProductBean.specifications}" var="sp" itemLabel="#{sp.name}" itemValue="#{sp}"   />                    
                                </p:selectOneMenu>
                                <p:message for="dimensioTypeField" display="icon" /> 
                            </td>
                        </tr>
                        <tr>
                            <td><p:outputLabel style="font-weight: bold; vertical-align: top" value="#{bundle.dimensionValue} :*"   />  </td>
                            <td><p:inputText size="5" value="#{newProductBean.svalue}"  converter="DoubleConverter" converterMessage="#{bundle.notValidNumber}"
                                             required="true" requiredMessage="#{bundle.value}: #{bundle.mandatoryField}" id="dimensionField" >
                                    <f:validateDoubleRange minimum="0.00" maximum="1000000.00" /> 
                                </p:inputText>
                                <p:message for="dimensionField" display="icon" /> 
                            </td>
                        </tr>
                        <tr>
                            <td><p:outputLabel style="font-weight: bold; vertical-align: top" value="#{bundle.measurment} :*"   /></td>
                            <td><p:selectOneMenu id="measurmentField" value="#{newProductBean.selectedMeasurment}" converter="MeasurmentConverter" required="true" requiredMessage="#{bundle.mesurment}: #{bundle.mandatoryField}">						                    
                                    <f:selectItems value="#{applicationBean.measurments}" var="measurment" itemLabel="#{measurment.name}" itemValue="#{measurment}"   />                    
                                </p:selectOneMenu>
                                <p:message for="measurmentField" display="icon" /> 
                            </td>                            
                        </tr>
                    </table>
                </p:panel>    

                <p:separator />

                <p:commandButton id="bt33" update="@widgetVar(dimensionDatatableWidget)" action="#{furnitureAction.insertDimensionAction()}"  value="#{bundle.insert}" />                                                                      

            </p:dialog>
        </h:form>




        <!--oncomplete="PF('carDialog').show()" -->

        <p:dialog id="dialogFotosID" position="top" widgetVar="dialogFotos" modal="true" minWidth="600" minHeight="500" header="#{bundle.selectImage}" resizable="false">
            <p:messages id="selectPatientMsg" autoUpdate="true" severity="error" /> 
            <h:form prependId="false" enctype="multipart/form-data">
                <p:fileUpload fileUploadListener="#{furnitureAction.handleFileUpload}"
                              update=":imgData"
                              cancelLabel="#{bundle.cancel}"
                              fileLimit="20"
                              sizeLimit="500000"                        
                              fileLimitMessage="#{bundle.invalidImageSize}"
                              label="#{bundle.select}"
                              invalidFileMessage="#{bundle.invalidImageType}"
                              invalidSizeMessage="#{bundle.imageTooBig}"
                              uploadLabel="#{bundle.upload}"
                              multiple="true"
                              allowTypes="/(\.|\/)(jpe?g|png)$/"  >

                </p:fileUpload>
            </h:form>

            <h:form id="imgData">
                <p:outputPanel id="productPhoto">
                    <h:panelGrid>
                        <p:graphicImage cache="false" id="imagemTmp" value="../temp/#{newProductBean.newImage.filename}" height="300" style="margin: 0 auto;"/>
                        <h:outputText style="font-weight: bold" value="#{bundle.ordered}*" rendered="#{newProductBean.newImage.filename!=null}" />
                        <p:inputMask mask="9" value="#{newProductBean.newImage.primary}" size="5" required="true" requiredMessage="#{bundle.ordered}: #{bundle.mandatoryField}" rendered="#{newProductBean.newImage.filename!=null}" />
                        <h:outputText style="font-weight: bold" value="#{bundle.description}" rendered="#{newProductBean.newImage.filename!=null}"/>
                        <p:inputTextarea  rows="5" cols="50" value="#{newProductBean.newImage.description}"  rendered="#{newProductBean.newImage.filename!=null}" />                        
                    </h:panelGrid>
                </p:outputPanel>
                <p:commandButton value="#{bundle.insert}" action="#{furnitureAction.savePhoto}" update="productPhoto :createProductForm:imageDataAdmin @this" rendered="#{newProductBean.newImage.filename!=null}" />            
            </h:form>
        </p:dialog>


        <h:form id="galeriaForm">
            <p:dialog id="dialogGaleriaID" widgetVar="dialogGaleria" modal="true" position="top" minWidth="440" minHeight="500">
                <p:galleria value="#{newProductBean.images}" var="image" panelWidth="500" panelHeight="313" showCaption="true">  
                    <p:graphicImage value="../temp/#{image.filename}" alt="#{image.description}" title="#{image.filename}"/>  
                </p:galleria>
            </p:dialog>
        </h:form>











        <p:dialog id="dialogVideosID" position="top" widgetVar="dialogVideos" modal="true" minWidth="600" minHeight="500" header="#{bundle.selectVideo}" resizable="false">
            <p:messages id="selectVideoMsg" autoUpdate="true" severity="error" /> 
            <h:form prependId="false" enctype="multipart/form-data">
                <p:fileUpload fileUploadListener="#{furnitureAction.handleFileUploadVideo}"
                              update=":videoData"
                              cancelLabel="#{bundle.cancel}"
                              fileLimit="2000000"
                              fileLimitMessage="#{bundle.videoTooBig}"
                              label="#{bundle.select}"
                              invalidFileMessage="#{bundle.invalidVideoType}"
                              invalidSizeMessage="#{bundle.invalidVideoSize}"
                              uploadLabel="#{bundle.upload}"
                              multiple="false"
                              allowTypes="/(\.|\/)(mov|avi|mp4|mpeg4)$/">

                </p:fileUpload>
            </h:form>

            <h:form id="videoData">
                <p:outputPanel id="productVideo">

                    <p:media value="../temp/#{newProductBean.newVideo.filename}" width="500" height="400"  rendered="#{newProductBean.newVideo.filename!=null}">  
                        <f:param name="autoPlay" value="false" />  
                    </p:media> 
                    <table  cellpadding="4">
                        <tr>                                
                            <td>  
                                <h:outputText style="font-weight: bold" value=" #{bundle.ordered}*" rendered="#{newProductBean.newVideo.filename!=null}" />
                                <p:inputMask mask="9" value="#{newProductBean.newVideo.primary}" size="4" required="true" requiredMessage="#{bundle.ordered}: #{bundle.mandatoryField}" rendered="#{newProductBean.newVideo.filename!=null}" />                       
                            </td>
                            <td style="vertical-align: middle">
                                <h:outputText  style="font-weight: bold; " value="#{bundle.description}:" rendered="#{newProductBean.newVideo.filename!=null}"/>
                                <p:inputTextarea  rows="4" cols="40" value="#{newProductBean.newVideo.description}" rendered="#{newProductBean.newVideo.filename!=null}" />                                                                              
                            </td>

                        </tr>
                    </table>                   


                </p:outputPanel>
                <p:commandButton value="#{bundle.insert}" action="#{furnitureAction.saveVideo}" update="productVideo :createProductForm:imageDataAdmin @this" rendered="#{newProductBean.newVideo.filename!=null}" />            
            </h:form>
        </p:dialog>




        <h:form id="galeriaVideoForm">
            <p:dialog id="dialogGaleriaVideoID" widgetVar="dialogGaleriaVideo" modal="true" position="top" minWidth="500" minHeight="500" resizable="false" header="#{bundle.productVideos}">
                <p:dataTable value="#{newProductBean.videos}" var="video" rows="1" paginator="true"> 
                    <p:column> 
                        <p:media value="../temp/#{video.filename}" width="480" height="450"   >  
                            <f:param name="autoPlay" value="false" />  
                        </p:media>
                        <p:outputLabel style="font-weight: bold" value="#{video.description}" />
                    </p:column>                
                </p:dataTable>
            </p:dialog>
        </h:form>




        <h:form id="productPreviewForm">
            <p:dialog header="#{bundle.productPreview}" id="productPreviewID" position="top" widgetVar="productPreviewDialog" modal="true" resizable="false" >
                <p:panelGrid>
                    <f:facet name="header"> 
                        <p:row>  
                            <p:column colspan="1"><p:outputLabel value="#{bundle.name}:" style="font-weight: bold;vertical-align: top;float: right"/></p:column>  
                            <p:column colspan="5"><p:outputLabel value="#{newProductBean.newProduct.name}" /></p:column>  
                        </p:row> 
                    </f:facet>



                    <p:row>  
                        <!--<p:column colspan="1"><p:outputLabel value="#{bundle.subProduct}:" style="font-weight: bold;vertical-align: top;float: right"/></p:column>  
                        <p:column colspan="3">
                            <p:outputLabel value="#{bundle.yes} " rendered="#{newProductBean.newProduct.subproduct==1}" />
                            <p:outputLabel value=" - (#{newProductBean.newProduct.product.name})" rendered="#{newProductBean.newProduct.subproduct==1}" />
                            <p:outputLabel value="#{bundle.no} " rendered="#{newProductBean.newProduct.subproduct==0}" />
                        </p:column> -->

                        <p:column rowspan="8"  ><p:outputLabel value="#{bundle.images}: " style="font-weight: bold;vertical-align: top;float: right" /></p:column> 
                        <p:column rowspan="8">
                            <p:galleria id="imageGaler" value="#{newProductBean.newProduct.imageproducts}" var="image" panelWidth="330" panelHeight="370" autoPlay="false" 
                                        frameWidth="40" frameHeight="40" effect="clip">  
                                <p:graphicImage id="produImage" value="../temp/#{image.filename}" alt="" title="#{image.description}" height="50" width="50"/>  
                                <f:facet name="content">  
                                    <h:panelGrid  columns="2" cellpadding="0" style="border-style: none; font-weight: 8px; border-width:1px ! important;
                                                  border-style:none ! important;">  
                                        <f:facet name="header">  
                                            <p:graphicImage value="../temp/#{image.filename}" height="300" width="330" />  
                                        </f:facet>  

                                        <p:outputLabel value="#{bundle.description}: " style="font-weight: bold;" />  
                                        <p:outputLabel value="#{image.description}"/>  

                                        <p:outputLabel value="#{bundle.ordered}: " style="font-weight: bold;" />  
                                        <p:outputLabel id="number" value="#{image.primary}"/>  
                                    </h:panelGrid>  
                                </f:facet>  

                            </p:galleria> 
                        </p:column>  



                    </p:row>

                    <p:row>  
                        <p:column ><p:outputLabel value="#{bundle.company}:" style="font-weight: bold;vertical-align: top;float: right"/></p:column> 
                        <p:column colspan="3">
                            <ui:repeat var="companyProduct" value="#{newProductBean.newProduct.orderedCompanies}" >
                                <p:outputLabel value="#{companyProduct.name} "/>                                     
                            </ui:repeat>
                        </p:column>  
                    </p:row>

                    <p:row>  
                        <p:column colspan="1"><p:outputLabel value="#{bundle.description}:" style="font-weight: bold;vertical-align: top;float: right"/></p:column>  
                        <p:column colspan="3"><p:outputLabel value="#{newProductBean.newProduct.description}" /></p:column>  
                    </p:row> 

                    <p:row>  
                        <p:column colspan="1"><p:outputLabel value="#{bundle.insertDate}:" style="font-weight: bold;vertical-align: top;float: right"/></p:column>  
                        <p:column colspan="3"><h:outputLabel  converter="DateConverter"  value="#{newProductBean.newProduct.createddate}"   /></p:column>  
                    </p:row>

                    <p:row>  
                        <p:column colspan="1"><p:outputLabel value="#{bundle.productCategory}:" style="font-weight: bold;vertical-align: top;float: right"/></p:column>  
                        <p:column colspan="3"><p:outputLabel value="#{newProductBean.newProduct.productcategory.name}" /></p:column>  
                    </p:row>



                    <p:row>  
                        <p:column ><p:outputLabel value="#{bundle.productLine}:" style="font-weight: bold;vertical-align: top;float: right"/></p:column> 
                        <p:column colspan="3">
                            <ui:repeat var="productLineProduct" value="#{newProductBean.newProduct.orderedProductlines}" >
                                <p:outputLabel value="#{productLineProduct.name} "/>                                     
                            </ui:repeat>
                        </p:column>  
                    </p:row>

                    <p:row>  
                        <p:column colspan="1"><p:outputLabel value="#{bundle.productTemplate}:" style="font-weight: bold;vertical-align: top;float: right"/></p:column>  
                        <p:column colspan="3"><p:outputLabel value="#{newProductBean.newProduct.item.name}" rendered="#{newProductBean.newProduct.item!=null}" /></p:column>  
                    </p:row>


                    <p:row>  
                        <p:column colspan="1"><p:outputLabel value="Video:" style="font-weight: bold;vertical-align: top;float: right"/></p:column>  
                        <p:column colspan="3">                            
                            <p:commandButton id="vidBtn" type="button"  rendered="#{newProductBean.newProduct.videoproducts.size()>0}"  
                                             value="#{bundle.view}" onclick="videoDlg.show()" />                                                        
                        </p:column>  
                    </p:row>

                    <p:row>  
                        <p:column colspan="6" styleClass="ui-widget-header">  
                            <p:outputLabel value="#{bundle.productCharacteristics} "/>    
                        </p:column>  
                    </p:row>

                    <p:row>
                        <p:column colspan="6">                           
                            <p:dataTable var="pss" value="#{newProductBean.newProduct.productspecifications}" styleClass="hide-column-names" >
                                <p:column width="20%" >  
                                    <p:outputLabel value="#{pss.specification.name}: " style="font-weight: bold;vertical-align: top;float: right"/> 
                                </p:column> 
                                <p:column width="80%">                                         
                                    <ui:repeat var="prr" value="#{pss.productvalues}" >
                                        <h:outputText value="#{prr.svalue.name}" rendered="#{prr.svalue!=null}" /> 
                                        <h:outputText value="#{prr.value}" rendered="#{prr.svalue==null}" /> 
                                    </ui:repeat>                                         
                                </p:column>  

                            </p:dataTable>                           
                        </p:column>                       
                    </p:row>                                                         
                </p:panelGrid><br/>
                <p:commandButton value="#{bundle.proceedInsertProduct}" action="#{furnitureAction.confirmInsertProduct}"/>
                <p:commandButton value="#{bundle.cancel}" type="button" onclick="productPreviewDialog.hide()" />
            </p:dialog>


            <p:dialog header="Videos" id="videoDlgID" position="top" widgetVar="videoDlg" modal="true" resizable="false" >
                <p:dataTable value="#{newProductBean.newProduct.videoproducts}" var="video" rows="1" paginator="true"> 
                    <p:column> 
                        <p:media value="../temp/#{video.filename}" width="480" height="450"   >  
                            <f:param name="autoPlay" value="false" />  
                        </p:media>
                        <p:outputLabel style="font-weight: bold" value="#{video.description}" />
                    </p:column>                
                </p:dataTable>                
            </p:dialog>

        </h:form>           
    </ui:define>
</ui:composition>